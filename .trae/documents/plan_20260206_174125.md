Este plano incorpora a correção do bug de créditos, o aumento da janela de agendamento e a regra refinada de visibilidade do botão, respeitando rigorosamente os tipos de crédito existentes e suas restrições.

### Arquivos e Componentes Afetados

1. **`services/learning/schedulingService.ts`** (Backend)
   * Lógica de validação de créditos (`canReschedule`).
   * Lógica de execução do reagendamento (`rescheduleClass`).
   * Configuração da janela de agendamento (`horizonDays`).

2. **`components/student/StudentClassesComponent.tsx`** (Frontend)
   * Lógica de controle de exibição do botão "Reagendar".

### Passos de Implementação

#### 1. Backend: `services/learning/schedulingService.ts`

* **Atualizar `canReschedule`**:
  * Adicionar parâmetro `targetDate`.
  * Validar limites baseando-se no mês da `targetDate` (se fornecida).

* **Atualizar `rescheduleClass`**:
  * Passar `newScheduledAt` para `canReschedule`.
  * Incrementar o contador do mês de destino.
  * Aumentar `horizonDays` para **60 dias**.

* **Atualizar `bookClass`**:
  * Aumentar `horizonDays` para **60 dias**.

#### 2. Frontend: `components/student/StudentClassesComponent.tsx`

* **Nova Lógica de Visibilidade (`canReschedule` prop)**:
  
  A visibilidade do botão respeitará a seguinte hierarquia de regras:

  1. **Restrições da Aula (Já existente)**: Se a aula não for reagendável (ex: créditos de bônus/atraso sem permissão), o botão permanece oculto/desabilitado.
  2. **Isenção de Limite**: Se o status for `canceled-teacher-makeup` (crédito de reposição do professor), o botão **sempre** aparece, independente de limites mensais.
  3. **Bloqueio por Limite Mensal (Nova Regra)**:
     * Se a aula for regular (ou crédito de reposição já agendado):
     * O botão será **ocultado** apenas se: (Mês Selecionado for Futuro) **E** (Limite daquele mês estiver esgotado).
     * O botão será **exibido** se o mês estiver esgotado mas for o Mês Atual (permitindo reagendar para um mês futuro livre).

* **Ação do Usuário (`handleRescheduleClick`)**:
  * Remover o bloqueio preventivo baseado no mês atual, permitindo a abertura do modal para seleção de datas futuras.

### Consideração sobre Tipos de Crédito
O sistema respeitará as definições de `RegularCreditType` (`bonus`, `late-students`, `teacher-cancellation`). Aulas criadas com créditos que possuem `isReschedulable: false` continuarão bloqueadas. Apenas aulas elegíveis passarão pela nova lógica de "mês futuro".
