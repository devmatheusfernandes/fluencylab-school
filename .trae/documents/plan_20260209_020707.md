# Plano de Implementação: Controle Manual de Áudio no Quiz

Este plano detalha as alterações necessárias para adicionar um campo explícito de intervalo de áudio (`audioRange`) às perguntas do quiz, removendo a dependência de Regex no texto da pergunta.

## 1. Atualização do Modelo de Dados (Types)

**Arquivo:** `types/learning/lesson.ts`

* Adicionar o campo opcional `audioRange` na interface `QuizQuestion`.

```typescript
export interface QuizQuestion {
  // ... campos existentes
  audioRange?: {
    start: number; // em segundos
    end: number;   // em segundos
  };
}
```

## 2. Atualização da Geração via IA

**Arquivo:** `actions/lessonProcessing.ts`

* Atualizar o prompt do Gemini para que ele popule o campo `audioRange` ao gerar perguntas da seção "timestamps".

* Instrução explícita para usar segundos (ex: 120 para 2:00).

## 3. Atualização da Lógica de Consumo (Frontend Logic)

**Arquivo:** `lib/learning/practiceLogic.ts`

* Alterar a função `generateQuizItems`:

  1. Verificar primeiro se `question.audioRange` existe.
  2. Se existir, usar esses valores para criar o `audioSegment`.
  3. Se não existir (legado), manter a lógica de Regex apenas como fallback para quizzes antigos.
  4. Manter a verificação de tipo de seção (apenas "timestamp", "listening") para evitar players indesejados.

## 4. Atualização do Editor de Quiz (UI)

**Arquivo:** `components/lessons/LessonQuizEditor.tsx`

* Adicionar campos de input numérico para "Início (s)" e "Fim (s)" no formulário de edição de pergunta.

* Esses campos aparecerão apenas se a seção for do tipo "timestamps" ou "listening".

* Permitir que o administrador ajuste manualmente o tempo exato, garantindo precisão milimétrica se necessário.

## Benefícios

* **Precisão:** Controle exato do áudio sem depender da formatação do texto.

* **Flexibilidade:** O texto da pergunta fica livre para ser escrito de qualquer forma.

* **Manutenção:** Facilita a correção de bugs de áudio diretamente pelo editor, sem precisar reescrever a pergunta.

